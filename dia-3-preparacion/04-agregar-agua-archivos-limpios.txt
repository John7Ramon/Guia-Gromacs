# ===================================================================
# D√çA 3 - PASO 4: AGREGAR ATOMTYPES DE AGUA Y CREAR ARCHIVOS LIMPIOS
# ===================================================================
# EJECUTAR: En Ubuntu (WSL) - directorio con atomtypes_consolidados.txt del paso anterior
# Completar atomtypes con agua SPC/E y crear archivos .itp sin secciones duplicadas
# Copia desde la siguiente linea
echo "üíß AGREGANDO ATOMTYPES DE AGUA SPC/E"
echo "==================================="
cat >> atomtypes_consolidados.txt << 'EOF'
 OW       OW          0.00000  0.00000   A     3.15061e-01   6.36386e-01 ; SPC/E water O
 HW       HW          0.00000  0.00000   A     0.00000e+00   0.00000e+00 ; SPC/E water H
EOF
echo "‚úÖ Atomtypes de agua agregados"
echo ""
echo "üìã ATOMTYPES FINALES CONSOLIDADOS:"
echo "Total: $(grep -v "^;" atomtypes_consolidados.txt | grep -v "^$" | wc -l) atomtypes"
echo "Lista: $(grep -v "^;" atomtypes_consolidados.txt | grep -v "^$" | awk '{print $1}' | paste -sd ', ')"
echo ""
echo "üßπ CREANDO ARCHIVOS .ITP LIMPIOS"
echo "================================"
echo "üìÑ Creando aceto_clean.itp..."
awk '
/\[ atomtypes \]/ { 
    print "; [atomtypes] section moved to sistema.top"
    skip=1
    next 
}
/^\[/ && skip { 
    skip=0 
}
!skip { 
    print 
}
' aceto.itp > aceto_clean.itp
echo "üìÑ Creando pva_polymer_clean.itp..."
awk '
/\[ atomtypes \]/ { 
    print "; [atomtypes] section moved to sistema.top"
    skip=1
    next 
}
/^\[/ && skip { 
    skip=0 
}
!skip { 
    print 
}
' pva_polymer.itp > pva_polymer_clean.itp
echo ""
echo "‚úÖ ARCHIVOS LIMPIOS CREADOS:"
echo "  ‚Ä¢ aceto_clean.itp (sin atomtypes)"
echo "  ‚Ä¢ pva_polymer_clean.itp (sin atomtypes)"
echo ""
echo "üîç VERIFICACI√ìN DE ARCHIVOS LIMPIOS:"
echo "Inicio de aceto_clean.itp:"
head -5 aceto_clean.itp
echo ""
echo "Inicio de pva_polymer_clean.itp:"
head -5 pva_polymer_clean.itp
# Copia hasta la linea anterior 
# Pegalo en tu terminal con ctrl + shift + V y dale enter para ejecutar
# ARCHIVOS GENERADOS:
# - atomtypes_consolidados.txt (actualizado con atomtypes de agua SPC/E)
# - aceto_clean.itp (sin secci√≥n [atomtypes])
# - pva_polymer_clean.itp (sin secci√≥n [atomtypes])
# IMPORTANTE: Los archivos _clean.itp se incluir√°n en el archivo .top principal
# El sistema queda preparado para crear la topolog√≠a completa del sistema
