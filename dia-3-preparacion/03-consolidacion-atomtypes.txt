# ===================================================================
# D√çA 3 - PASO 3: CONSOLIDACI√ìN DE ATOMTYPES
# ===================================================================
# EJECUTAR: En Ubuntu (WSL) - directorio con archivos .itp que tienen atomtypes duplicados
# Resolver duplicados de atomtypes entre archivos .itp creando archivo consolidado √∫nico
# Copia desde la siguiente linea
echo "üî¨ CONSOLIDACI√ìN DE ATOMTYPES"
echo "============================"
echo "üìã Creando lista de atomtypes √∫nicos..."
{
    echo "; Atomtypes consolidados desde:"
    echo "; - aceto.itp (acetaminofen)"
    echo "; - pva_polymer.itp (pva_polymer)"
    echo ""
    
    awk '/\[ atomtypes \]/{flag=1; next} /^\[/{flag=0} flag && NF>0 && !(/^;/) {print}' aceto.itp
    
    awk '/\[ atomtypes \]/{flag=1; next} /^\[/{flag=0} flag && NF>0 && !(/^;/) {print}' pva_polymer.itp
    
} | awk '
/^;/ || /^$/ {print; next}
{
    if (!seen[$1]) {
        seen[$1] = 1
        print
    }
}
' > atomtypes_consolidados.txt
echo "‚úÖ Atomtypes consolidados en: atomtypes_consolidados.txt"
echo ""
echo "üìä RESULTADO:"
echo "Atomtypes √∫nicos consolidados:"
grep -v "^;" atomtypes_consolidados.txt | awk '{print $1}' | paste -sd ', '
echo ""
echo "Total: $(grep -v "^;" atomtypes_consolidados.txt | wc -l) atomtypes √∫nicos"
# Copia hasta la linea anterior 
# Pegalo en tu terminal con ctrl + shift + V y dale enter para ejecutar
# CONSOLIDACI√ìN REALIZADA:
# - Extracci√≥n de atomtypes de aceto.itp y pva_polymer.itp
# - Eliminaci√≥n autom√°tica de duplicados (primera definici√≥n prevalece)
# - Generaci√≥n de atomtypes_consolidados.txt con atomtypes √∫nicos
# - Resoluci√≥n de duplicados c3, hc, ho, oh detectados en diagn√≥stico
# IMPORTANTE: El archivo generado se usar√° en pasos posteriores
# No modificar manualmente atomtypes_consolidados.txt
